<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.11: http://docutils.sourceforge.net/" />
<title>Unity Using NoesisGUI within Unity</title>
<link rel="stylesheet" href="style/noesis.css" type="text/css" />
</head>
<body>
<div class="document" id="unity-using-noesisgui-within-unity">
<div>
    <div class="headerbg">
        <center><img src="NoesisLogo.png" class="headerimg"/></center>
    </div>
    <div class="headermenu">
        <a href="Gui.Core.Index.html" class="headerlink">Documentation Index</a>
    </div>
</div>
<h1 class="title"><img alt="Unity" class="align-middle" src="unity.jpg" /> Using NoesisGUI within Unity</h1>

<p>Steps needed to render user interfaces using NoesisGUI in <a class="reference external" href="http://unity3d.com/">Unity</a> are described in this tutorial. It is recommended that you read the rest of <a class="reference external" href="Gui.Core.Index.html">tutorials</a> to have familiarity with the basic concepts of Xaml and NoesisGUI architecture. This document is structured as follows:</p>
<ul class="simple">
<li>How to install NoesisGUI in Unity</li>
<li>How data is organized</li>
<li>Configuring NoesisGUI</li>
<li>Steps to add new resources to your project</li>
<li>How to attach a .xaml to a camera</li>
<li>Render to Texture</li>
<li>How to implement code behind in Unity</li>
<li>Advanced topics like UserControls and Commands</li>
<li>Extra instructions for building on iOS and Android</li>
</ul>
<p>Several of these steps are shown in this <a class="reference external" href="http://vimeo.com/65549290">Video tutorial</a>.</p>
<div class="section" id="installation">
<h1>Installation</h1>
<p>The first thing is installing the provided <strong>NoesisGUI-X.X.X.XXXX.unitypackage</strong> into your Unity project. You can do this by clicking on the Unity menu option</p>
<blockquote>
<em>Assets</em> -&gt; <em>Import Package</em> -&gt; <em>Custom Package...</em></blockquote>
<p>and selecting the file NoesisGUI-X.X.X.XXXX.unitypackage that you have downloaded from our web page.</p>
<img alt="Unity3DTutorialImg1.png" src="Unity3DTutorialImg1.png" />
</div>
<div class="section" id="directory-structure">
<h1>Directory Structure</h1>
<p>After importing the package into the project, the following directories appears:</p>
<ul class="simple">
<li><strong>Assets/Editor/NoesisGUI</strong>: contains all the scripts and tools that are used while in Unity Editor</li>
<li><strong>Assets/NoesisGUI/Doc</strong>: with all the documentation corresponding to NoesisGUI, including this document</li>
<li><strong>Assets/NoesisGUI/Samples</strong>: our demo scenes showing different features of NoesisGUI</li>
<li><strong>Assets/NoesisGUI/Themes</strong>: sample themes for styling your controls</li>
<li><strong>Assets/Plugins</strong>: root folder that stores libraries and scripts that are needed in runtime for each platform</li>
<li><strong>Assets/StreamingAssets/NoesisGUI</strong>: contains the preprocessed resources to be used in runtime by each platform. This folder is copied entirely to the standalone executable. For now, there is no filtering implemented. To reduce the size of the final distributable it is recommended to prune the unused folders in the standalone, not in this directory because the content would be lost.</li>
</ul>
</div>
<div class="section" id="configuring-noesisgui">
<h1>Configuring NoesisGUI</h1>
<p>The integration of NoesisGUI inside Unity provides automatic resource building. This means that you don't have to use external tools to prepare the resources for runtime. Each time you add, delete, move or edit a .xaml or .font the data base is updated accordingly.</p>
<p>You only have to indicate the desired platforms. The corresponding platform must be active before generating the standalone package. Note that DX9 or GL should be always selected because it is the platform used by the Unity editor.</p>
<img alt="Unity3DTutorialImg21.png" src="Unity3DTutorialImg21.png" />
<img alt="Unity3DTutorialImg22.png" src="Unity3DTutorialImg22.png" />
<div class="admonition-note admonition">
<p class="first admonition-title">Note</p>
<blockquote class="last">
For now only DirectX9, OpenGL, iOS and Android platforms are supported.</blockquote>
</div>
</div>
<div class="section" id="adding-new-resources">
<h1>Adding new resources</h1>
<p>You are free to put resources in any place inside the project /Assets folder. Next to each resource a .make file is automatically generated to track the resource.</p>
<p>There are two types of resources recognized by NoesisGUI:</p>
<ul class="simple">
<li><strong>.xaml</strong>: generated by your favorite editor or by hand. The unique restriction here is that Window or App classes cannot be used because the application is managed by Unity itself. The same for the Window, that is created by Unity.</li>
<li><strong>.font</strong>: a font resource is a text file with a list of file font references, one item per line. For example, Roboto.font contains:</li>
</ul>
<div class="highlight"><pre>Roboto-Regular.ttf
Roboto-Italic.ttf
Roboto-Bold.ttf
Roboto-BoldItalic.ttf
</pre></div>
<p>Note that referenced .ttf files must be found next to the .font file. The .font file can contain as many references as you wish, even a single one, but it is recommended that all the referenced files belongs to the same font family being that family the name of the .font file.</p>
<p>The above .font could be used this way:</p>
<div class="highlight"><pre><span class="nt">&lt;Grid&gt;</span>
    <span class="nt">&lt;Button</span> <span class="na">Content=</span><span class="s">&quot;Click Me!&quot;</span> <span class="na">FontFamily=</span><span class="s">&quot;Fonts/#Roboto&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Button</span> <span class="na">Content=</span><span class="s">&quot;Click Me!&quot;</span> <span class="na">FontFamily=</span><span class="s">&quot;Fonts/#Roboto&quot;</span> <span class="na">FontWeight=</span><span class="s">&quot;Bold&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/Grid&gt;</span>
</pre></div>
<p>Note that the reference to the font is relative to the location of the .xaml file. Here we are supposing that Roboto.font is located in the subfolder Fonts/ relative to the .xaml.</p>
<p>Referenced fonts must always be inside the project folder. Operating system fonts are not supported for example.</p>
<p>You might be wondering why images are not considered resources themselves. For example,</p>
<div class="highlight"><pre><span class="nt">&lt;Image</span> <span class="na">Source=</span><span class="s">&quot;Images/Icon.png&quot;</span><span class="nt">/&gt;</span>
</pre></div>
<p>The reason is that images referenced by a xaml are all bundled together within the .xaml when being preprocessed for runtime. This is a behavior that may change in the future.</p>
</div>
<div class="section" id="camera-rendering">
<h1>Camera Rendering</h1>
<p>For rendering a user interface on top of a camera you must attach the <strong>Noesis GUIPanel</strong> component to that camera.</p>
<img alt="Unity3DTutorialImg3.png" src="Unity3DTutorialImg3.png" />
<p>With the component attached inspect the object to display its options.</p>
<img alt="Unity3DTutorialImg4.png" src="Unity3DTutorialImg4.png" />
<p>These are the fields exposed by every NoesisGUI component:</p>
<ul class="simple">
<li><strong>Xaml</strong>: This field contains the interface resource that will be loaded when game is played. Any .xaml from the project folder can be dragged here. Note that only xamls with a FrameworkElement derived root can be rendered.</li>
<li><strong>Style</strong>: A xaml resource that describes how different controls (Buttons, CheckBoxes, ListBoxes, etc) are visually represented. Several themes are provided inside Assets/NoesisGUI: <em>NoesisStyle</em>, <em>SimpleStyle</em> and <em>WindowsStyle</em>.</li>
<li><strong>Antialiasing</strong>: Defines the desired antialiasing technique. The MSAA option renders using the multisampling antialiasing algorithm that is implemented by moderns GPUs. In case this option is not available or its performance is not acceptable the PPA option can be used. PPA implements antialiasing by extruding the contours of the triangles smoothing them. Shapes are slightly altered by this technique though.</li>
<li><strong>Quality</strong>: Adjusts the number of polygons that are generated when curve paths are tessellated. The default quality provides an error inferior to 0.5 pixels.</li>
<li><strong>Offscreen resolution</strong>: Specifies offscreen surfaces resolution relative to main surface. For example, a Offscreen Width 2 indicates that offscreen surfaces will dobule the width of the main window. Offscreen surfaces are used for opacity groups and visual brushes. A 0 size disables this feature. By default, it is 1. Normaly, two offscreen surfaces are created.</li>
<li><strong>Real Time Clock</strong>: When enabled, Time.realtimeSinceStartup is used instead of Time.time for animations. This can be used, for example, to make a user interface that is not affected by game slow motions.</li>
</ul>
<p>Once you have set a valid xaml file press the <strong>Play</strong> button in the Editor and the <strong>Game View</strong> will render your scene, and on top of it, the selected UI resource.</p>
<img alt="Unity3DTutorialImg6.png" src="Unity3DTutorialImg6.png" />
</div>
<div class="section" id="render-to-texture">
<h1>Render to Texture</h1>
<p>Sometimes you don't want the user interface to be directly rendered to the screen or camera. NoesisGUI supports rendering XAML to textures that are mapped to the mesh of an object. For that purpose you must create a Unity RenderTexture.</p>
<img alt="Unity3DTutorialImg61.png" src="Unity3DTutorialImg61.png" />
<p><strong>NOTE:</strong> The Depth Buffer is set to None because it is not needed.</p>
<p>This texture must be used by one of the materials of the Mesh, a Cube, in this example.</p>
<img alt="Unity3DTutorialImg62.png" src="Unity3DTutorialImg62.png" />
<p>And finally, the NoesisGUI component must be attached to the object. Once this have been done, the .xaml will be rendered onto the texture the next time you hit Play.</p>
<img alt="Unity3DTutorialImg63.png" src="Unity3DTutorialImg63.png" />
</div>
<div class="section" id="attaching-to-events">
<h1>Attaching to Events</h1>
<p>In contrast with the native version of NoesisGUI, .xaml resources in Unity does not support Code-Behind classes automatically. But it can be easily emulated by a script that in the Start() function caches the named nodes and attaches to desired events.</p>
<p>If you want to react to user interface events you need to create a script component and attach it to your GameObject. For example, let's attach the <em>CodeBehind.cs</em> script:</p>
<img alt="Unity3DTutorialImg7.png" src="Unity3DTutorialImg7.png" />
<p>Next thing you probably want is caching &quot;interesting&quot; nodes inside your script. This can be done using the <em>FindName()</em> function. Best place for this code is inside the <em>Start()</em> function provided by the base class <em>MonoBehaviour</em>.</p>
<div class="highlight"><pre><span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">CodeBehind</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
<span class="p">{</span>
    <span class="n">Button</span> <span class="n">_button</span><span class="p">;</span>
    <span class="n">Slider</span> <span class="n">_slider</span><span class="p">;</span>

    <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// Access to the NoesisGUI component</span>
        <span class="n">NoesisGUI</span> <span class="n">noesisGUI</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">NoesisGUI</span><span class="p">&gt;();</span>

        <span class="c1">// Obtain the root of the loaded UI resource, in this case it is a Grid element</span>
        <span class="n">Grid</span> <span class="n">grid</span> <span class="p">=</span> <span class="n">noesisGUI</span><span class="p">.</span><span class="n">GetRoot</span><span class="p">&lt;</span><span class="n">Grid</span><span class="p">&gt;();</span>

        <span class="c1">// Store references to important elements for future use</span>
        <span class="n">_button</span> <span class="p">=</span> <span class="n">grid</span><span class="p">.</span><span class="n">FindName</span><span class="p">&lt;</span><span class="n">Button</span><span class="p">&gt;(</span><span class="s">&quot;Button1&quot;</span><span class="p">);</span>
        <span class="n">_slider</span> <span class="p">=</span> <span class="n">grid</span><span class="p">.</span><span class="n">FindName</span><span class="p">&lt;</span><span class="n">Slider</span><span class="p">&gt;(</span><span class="s">&quot;Delay&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<p>Binding to events exposed by each control is done through delegates.</p>
<div class="highlight"><pre> <span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
 <span class="k">using</span> <span class="nn">System.Collections</span><span class="p">;</span>

 <span class="k">public</span> <span class="k">class</span> <span class="nc">CodeBehind</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
 <span class="p">{</span>
     <span class="n">Button</span> <span class="n">_button</span><span class="p">;</span>
     <span class="n">Slider</span> <span class="n">_slider</span><span class="p">;</span>

     <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
     <span class="p">{</span>
         <span class="c1">// Access to the NoesisGUI component</span>
         <span class="n">NoesisGUI</span> <span class="n">noesisGUI</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">NoesisGUI</span><span class="p">&gt;();</span>

         <span class="c1">// Obtain the root of the loaded UI resource, in this case it is a Grid element</span>
         <span class="n">Grid</span> <span class="n">grid</span> <span class="p">=</span> <span class="n">noesisGUI</span><span class="p">.</span><span class="n">GetRoot</span><span class="p">&lt;</span><span class="n">Grid</span><span class="p">&gt;();</span>

         <span class="c1">// Store references to important elements for future use</span>
         <span class="n">_button</span> <span class="p">=</span> <span class="n">grid</span><span class="p">.</span><span class="n">FindName</span><span class="p">&lt;</span><span class="n">Button</span><span class="p">&gt;(</span><span class="s">&quot;Button1&quot;</span><span class="p">);</span>
         <span class="n">_slider</span> <span class="p">=</span> <span class="n">grid</span><span class="p">.</span><span class="n">FindName</span><span class="p">&lt;</span><span class="n">Slider</span><span class="p">&gt;(</span><span class="s">&quot;Delay&quot;</span><span class="p">);</span>

<span class="hll">         <span class="c1">// Bind to button click event</span>
</span><span class="hll">         <span class="n">_button</span><span class="p">.</span><span class="n">Click</span> <span class="p">+=</span> <span class="k">this</span><span class="p">.</span><span class="n">OnButtonClick</span><span class="p">;</span>
</span>     <span class="p">}</span>

<span class="hll">     <span class="k">void</span> <span class="nf">OnButtonClick</span><span class="p">(</span><span class="n">BaseComponent</span> <span class="n">sender</span><span class="p">,</span> <span class="n">RoutedEventArgs</span> <span class="n">args</span><span class="p">)</span>
</span><span class="hll">     <span class="p">{</span>
</span><span class="hll">         <span class="n">Debug</span><span class="p">.</span><span class="n">Log</span><span class="p">(</span><span class="s">&quot;Button was clicked&quot;</span><span class="p">);</span>
</span><span class="hll">     <span class="p">}</span>
</span> <span class="p">}</span>
</pre></div>
</div>
<div class="section" id="extending-classes">
<h1>Extending classes</h1>
<p>Classes provided by NoesisGUI can be extended to provide new functionality. For example, the TicTacToe example extends the  <a class="reference external" href="Core.Kernel.Component.html">BaseComponent</a> class in the following way:</p>
<div class="highlight"><pre><span class="k">public</span> <span class="k">class</span> <span class="nc">Cell</span> <span class="p">:</span> <span class="n">Noesis</span><span class="p">.</span><span class="n">BaseComponent</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="n">HandleRef</span> <span class="n">swigCPtr</span><span class="p">;</span>

    <span class="k">public</span> <span class="kt">string</span> <span class="n">player</span>
    <span class="p">{</span>
        <span class="k">set</span> <span class="p">{</span> <span class="n">mPlayer</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">mPlayer</span><span class="p">;</span> <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">private</span> <span class="kt">string</span> <span class="n">mPlayer</span><span class="p">;</span>

    <span class="k">public</span> <span class="n">ToggleButton</span> <span class="n">btn</span>
    <span class="p">{</span>
        <span class="k">set</span> <span class="p">{</span> <span class="n">mBtn</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">mBtn</span><span class="p">;</span> <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">private</span> <span class="n">ToggleButton</span> <span class="n">mBtn</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Register</span><span class="p">()</span>
    <span class="p">{</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="nf">Cell</span><span class="p">(</span><span class="n">IntPtr</span> <span class="n">cPtr</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">cMemoryOwn</span><span class="p">)</span>
        <span class="p">:</span> <span class="k">base</span><span class="p">(</span><span class="n">cPtr</span><span class="p">,</span> <span class="n">cMemoryOwn</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">swigCPtr</span> <span class="p">=</span> <span class="k">new</span> <span class="n">HandleRef</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">cPtr</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="nf">Cell</span><span class="p">()</span>
        <span class="p">:</span> <span class="k">this</span><span class="p">(</span><span class="n">Noesis</span><span class="p">.</span><span class="n">Extend</span><span class="p">.</span><span class="n">New</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">Cell</span><span class="p">)),</span> <span class="k">true</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Noesis</span><span class="p">.</span><span class="n">Extend</span><span class="p">.</span><span class="n">Register</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">Cell</span><span class="p">),</span> <span class="n">swigCPtr</span><span class="p">.</span><span class="n">Handle</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">Dispose</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">lock</span> <span class="p">(</span><span class="k">this</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">swigCPtr</span><span class="p">.</span><span class="n">Handle</span> <span class="p">!=</span> <span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">swigCMemOwn</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">swigCMemOwn</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">Noesis</span><span class="p">.</span><span class="n">Kernel</span><span class="p">.</span><span class="n">IsInitialized</span><span class="p">())</span>
                    <span class="p">{</span>
                        <span class="n">Noesis</span><span class="p">.</span><span class="n">Extend</span><span class="p">.</span><span class="n">Delete</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">Cell</span><span class="p">),</span> <span class="n">swigCPtr</span><span class="p">.</span><span class="n">Handle</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="n">swigCPtr</span> <span class="p">=</span> <span class="k">new</span> <span class="n">HandleRef</span><span class="p">(</span><span class="k">null</span><span class="p">,</span> <span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="n">GC</span><span class="p">.</span><span class="n">SuppressFinalize</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
            <span class="k">base</span><span class="p">.</span><span class="n">Dispose</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>
<p>Every extension always follows the same pattern:</p>
<ul class="simple">
<li>You must inherit from the desired class. BaseComponent in this case.</li>
<li>The private HandleRef is needed to hold the reference to the internal C implementation of the base class.</li>
<li>A static method Register that will be used to automatically register this type into Noesis reflection system.</li>
<li>A special constructor that fills in the HandleRef. This constructor must be called from the rest of constructors implemented by the class. <em>Noesis.Extend.Register</em> must be invoked on each constructor.</li>
<li>The last step is overriding the method Dispose() that must be implemented as described above.</li>
</ul>
</div>
<div class="section" id="usercontrols">
<h1>UserControls</h1>
<p>To implement a UserControl we need a xaml describing the visual aspect and a class implementing the behavior. Shown below is the code corresponding to the ColorPicker that is implemented in the <em>Gui/Primitives</em> sample:</p>
<div class="highlight"><pre><span class="k">public</span> <span class="k">class</span> <span class="nc">ColorPicker</span> <span class="p">:</span> <span class="n">UserControl</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="n">HandleRef</span> <span class="n">swigCPtr</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">DependencyProperty</span> <span class="n">ColorProperty</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Register</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// Register the dependency properties</span>
        <span class="n">ColorProperty</span> <span class="p">=</span> <span class="n">DependencyProperty</span><span class="p">.</span><span class="n">Register</span><span class="p">(</span><span class="s">&quot;Color&quot;</span><span class="p">,</span> <span class="k">typeof</span><span class="p">(</span><span class="n">SolidColorBrush</span><span class="p">),</span>
            <span class="k">typeof</span><span class="p">(</span><span class="n">ColorPicker</span><span class="p">),</span> <span class="k">new</span> <span class="n">PropertyMetadata</span><span class="p">(</span><span class="k">null</span><span class="p">));</span>

        <span class="c1">// Override the source to indicate the user control xaml</span>
        <span class="n">UserControl</span><span class="p">.</span><span class="n">SourceProperty</span><span class="p">.</span><span class="n">OverrideMetadata</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">ColorPicker</span><span class="p">),</span>
            <span class="k">new</span> <span class="nf">PropertyMetadata</span><span class="p">(</span><span class="s">&quot;Assets/NoesisGUI/Samples/Primitives/ColorPicker.xaml&quot;</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="n">SolidColorBrush</span> <span class="n">Color</span>
    <span class="p">{</span>
        <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">GetValue</span><span class="p">&lt;</span><span class="n">SolidColorBrush</span><span class="p">&gt;(</span><span class="n">ColorProperty</span><span class="p">);</span> <span class="p">}</span>
        <span class="k">set</span> <span class="p">{</span> <span class="n">SetValue</span><span class="p">&lt;</span><span class="n">SolidColorBrush</span><span class="p">&gt;(</span><span class="n">ColorProperty</span><span class="p">,</span> <span class="k">value</span><span class="p">);</span> <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="nf">ColorPicker</span><span class="p">(</span><span class="n">IntPtr</span> <span class="n">cPtr</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">cMemoryOwn</span><span class="p">)</span>
        <span class="p">:</span> <span class="k">base</span><span class="p">(</span><span class="n">cPtr</span><span class="p">,</span> <span class="n">cMemoryOwn</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">swigCPtr</span> <span class="p">=</span> <span class="k">new</span> <span class="n">HandleRef</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">cPtr</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="nf">ColorPicker</span><span class="p">()</span>
        <span class="p">:</span> <span class="k">this</span><span class="p">(</span><span class="n">Noesis</span><span class="p">.</span><span class="n">Extend</span><span class="p">.</span><span class="n">New</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">ColorPicker</span><span class="p">)),</span> <span class="k">true</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Noesis</span><span class="p">.</span><span class="n">Extend</span><span class="p">.</span><span class="n">Register</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">ColorPicker</span><span class="p">),</span> <span class="n">swigCPtr</span><span class="p">.</span><span class="n">Handle</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">Dispose</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">lock</span> <span class="p">(</span><span class="k">this</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">swigCPtr</span><span class="p">.</span><span class="n">Handle</span> <span class="p">!=</span> <span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">swigCMemOwn</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">swigCMemOwn</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">Noesis</span><span class="p">.</span><span class="n">Kernel</span><span class="p">.</span><span class="n">IsInitialized</span><span class="p">())</span>
                    <span class="p">{</span>
                        <span class="n">Noesis</span><span class="p">.</span><span class="n">Extend</span><span class="p">.</span><span class="n">Delete</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">ColorPicker</span><span class="p">),</span> <span class="n">swigCPtr</span><span class="p">.</span><span class="n">Handle</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="n">swigCPtr</span> <span class="p">=</span> <span class="k">new</span> <span class="n">HandleRef</span><span class="p">(</span><span class="k">null</span><span class="p">,</span> <span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="n">GC</span><span class="p">.</span><span class="n">SuppressFinalize</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
            <span class="k">base</span><span class="p">.</span><span class="n">Dispose</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">OnPostInit</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// Initialize the user control here</span>

        <span class="c1">// User control elemetns</span>
        <span class="k">this</span><span class="p">.</span><span class="n">_r</span> <span class="p">=</span> <span class="n">FindName</span><span class="p">&lt;</span><span class="n">Slider</span><span class="p">&gt;(</span><span class="s">&quot;R&quot;</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="n">_g</span> <span class="p">=</span> <span class="n">FindName</span><span class="p">&lt;</span><span class="n">Slider</span><span class="p">&gt;(</span><span class="s">&quot;G&quot;</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="n">_b</span> <span class="p">=</span> <span class="n">FindName</span><span class="p">&lt;</span><span class="n">Slider</span><span class="p">&gt;(</span><span class="s">&quot;B&quot;</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="n">_a</span> <span class="p">=</span> <span class="n">FindName</span><span class="p">&lt;</span><span class="n">Slider</span><span class="p">&gt;(</span><span class="s">&quot;A&quot;</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="n">_hsv</span> <span class="p">=</span> <span class="n">FindName</span><span class="p">&lt;</span><span class="n">HSVControl</span><span class="p">&gt;(</span><span class="s">&quot;HSVControl&quot;</span><span class="p">);</span>

        <span class="c1">// Register events</span>
        <span class="k">this</span><span class="p">.</span><span class="n">_r</span><span class="p">.</span><span class="n">ValueChanged</span> <span class="p">+=</span> <span class="k">this</span><span class="p">.</span><span class="n">OnSliderValueChanged</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="n">_g</span><span class="p">.</span><span class="n">ValueChanged</span> <span class="p">+=</span> <span class="k">this</span><span class="p">.</span><span class="n">OnSliderValueChanged</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="n">_b</span><span class="p">.</span><span class="n">ValueChanged</span> <span class="p">+=</span> <span class="k">this</span><span class="p">.</span><span class="n">OnSliderValueChanged</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="n">_a</span><span class="p">.</span><span class="n">ValueChanged</span> <span class="p">+=</span> <span class="k">this</span><span class="p">.</span><span class="n">OnSliderValueChanged</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="n">_hsv</span><span class="p">.</span><span class="n">HSVChanged</span> <span class="p">+=</span> <span class="k">this</span><span class="p">.</span><span class="n">OnHSVChanged</span><span class="p">;</span>

        <span class="c1">// Initialize the data members</span>
        <span class="k">this</span><span class="p">.</span><span class="n">_isUpdatingColor</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="n">_isUpdatingSliders</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="n">_changingHSV</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">DependencyPropertyChanged</span><span class="p">(</span><span class="n">DependencyProperty</span> <span class="n">prop</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// Method invoked when a dependency property changes</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">prop</span> <span class="p">==</span> <span class="n">ColorProperty</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">SolidColorBrush</span> <span class="n">newValue</span> <span class="p">=</span> <span class="n">GetValue</span><span class="p">&lt;</span><span class="n">SolidColorBrush</span><span class="p">&gt;(</span><span class="n">prop</span><span class="p">);</span>
            <span class="n">OnColorChanged</span><span class="p">(</span><span class="n">newValue</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">OnSliderValueChanged</span><span class="p">(</span><span class="kt">float</span> <span class="n">oldValue</span><span class="p">,</span> <span class="kt">float</span> <span class="n">newValue</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(!</span><span class="k">this</span><span class="p">.</span><span class="n">_isUpdatingSliders</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">Color</span> <span class="p">==</span> <span class="k">null</span> <span class="p">||</span> <span class="k">this</span><span class="p">.</span><span class="n">Color</span><span class="p">.</span><span class="n">IsFrozen</span><span class="p">())</span>
            <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="n">_isUpdatingColor</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
                <span class="k">this</span><span class="p">.</span><span class="n">Color</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SolidColorBrush</span><span class="p">();</span>
                <span class="k">this</span><span class="p">.</span><span class="n">_isUpdatingColor</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="n">UpdateColor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">_r</span><span class="p">.</span><span class="n">GetValue</span><span class="p">(),</span> <span class="k">this</span><span class="p">.</span><span class="n">_g</span><span class="p">.</span><span class="n">GetValue</span><span class="p">(),</span> <span class="k">this</span><span class="p">.</span><span class="n">_b</span><span class="p">.</span><span class="n">GetValue</span><span class="p">(),</span> <span class="k">this</span><span class="p">.</span><span class="n">_a</span><span class="p">.</span><span class="n">GetValue</span><span class="p">());</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">OnColorChanged</span><span class="p">(</span><span class="n">SolidColorBrush</span> <span class="n">newValue</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(!</span><span class="k">this</span><span class="p">.</span><span class="n">_isUpdatingColor</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">UpdateSliders</span><span class="p">(</span><span class="n">newValue</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(!</span><span class="k">this</span><span class="p">.</span><span class="n">_changingHSV</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="n">_hsv</span><span class="p">.</span><span class="n">SetRGBA</span><span class="p">(</span><span class="n">newValue</span><span class="p">.</span><span class="n">GetColor</span><span class="p">());</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">UpdateColor</span><span class="p">(</span><span class="kt">float</span> <span class="n">r</span><span class="p">,</span> <span class="kt">float</span> <span class="n">g</span><span class="p">,</span> <span class="kt">float</span> <span class="n">b</span><span class="p">,</span> <span class="kt">float</span> <span class="n">a</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="n">_isUpdatingColor</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="n">Color</span><span class="p">.</span><span class="n">SetColor</span><span class="p">(</span><span class="k">new</span> <span class="n">Noesis</span><span class="p">.</span><span class="n">Color</span><span class="p">(</span><span class="n">r</span> <span class="p">/</span> <span class="m">255.0f</span><span class="p">,</span> <span class="n">g</span> <span class="p">/</span> <span class="m">255.0f</span><span class="p">,</span> <span class="n">b</span> <span class="p">/</span> <span class="m">255.0f</span><span class="p">,</span> <span class="n">a</span> <span class="p">/</span> <span class="m">255.0f</span><span class="p">));</span>

        <span class="k">if</span> <span class="p">(!</span><span class="k">this</span><span class="p">.</span><span class="n">_changingHSV</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="n">_hsv</span><span class="p">.</span><span class="n">SetRGBA</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">Color</span><span class="p">.</span><span class="n">GetColor</span><span class="p">());</span>
        <span class="p">}</span>

        <span class="k">this</span><span class="p">.</span><span class="n">_isUpdatingColor</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">UpdateSliders</span><span class="p">(</span><span class="n">SolidColorBrush</span> <span class="n">color</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="n">_isUpdatingSliders</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
        <span class="n">Noesis</span><span class="p">.</span><span class="n">Color</span> <span class="n">c</span> <span class="p">=</span> <span class="n">color</span><span class="p">.</span><span class="n">GetColor</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="n">_r</span><span class="p">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">GetRedF</span><span class="p">()</span> <span class="p">*</span> <span class="m">255.0f</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="n">_g</span><span class="p">.</span><span class="n">SetValue</span> <span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">GetGreenF</span><span class="p">()</span> <span class="p">*</span> <span class="m">255.0f</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="n">_b</span><span class="p">.</span><span class="n">SetValue</span> <span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">GetBlueF</span><span class="p">()</span> <span class="p">*</span> <span class="m">255.0f</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="n">_a</span><span class="p">.</span><span class="n">SetValue</span> <span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">GetAlphaF</span><span class="p">()</span> <span class="p">*</span> <span class="m">255.0f</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="n">_isUpdatingSliders</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">void</span> <span class="nf">OnHSVChanged</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="n">_changingHSV</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="n">Color</span><span class="p">.</span><span class="n">SetColor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">_hsv</span><span class="p">.</span><span class="n">GetRGBA</span><span class="p">());</span>
        <span class="n">UpdateSliders</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">Color</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="n">_changingHSV</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">Slider</span> <span class="n">_r</span><span class="p">;</span>
    <span class="n">Slider</span> <span class="n">_g</span><span class="p">;</span>
    <span class="n">Slider</span> <span class="n">_b</span><span class="p">;</span>
    <span class="n">Slider</span> <span class="n">_a</span><span class="p">;</span>

    <span class="n">HSVControl</span> <span class="n">_hsv</span><span class="p">;</span>

    <span class="kt">bool</span> <span class="n">_isUpdatingColor</span><span class="p">;</span>
    <span class="kt">bool</span> <span class="n">_isUpdatingSliders</span><span class="p">;</span>
    <span class="kt">bool</span> <span class="n">_changingHSV</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<p>Interesting points in this code:</p>
<ul class="simple">
<li>Extend from <em>UserControl</em> as described in the &quot;Extending Classes&quot; section.</li>
<li>Define all the DependencyProperties that are needed and register them in the static method Register().</li>
<li>Override the property <em>UserControl.Source</em> with the xaml associated to the UserControl.</li>
<li>Implement the accessors for each DependencyProperty.</li>
<li>The initialization of the UserControl is done inside the method <em>OnPostInit</em>. This method is invoked just after the xaml has been loaded. The logical tree of elements can be accessed at this point.</li>
<li>Changes on DependencyProperties are notified in the DependencyPropertyChanged() function.</li>
</ul>
</div>
<div class="section" id="value-change-notification">
<h1>Value Change Notification</h1>
<p>The <em>INotifyPropertyChanged</em> interface is used to notify clients, typically binding clients, that a property value has changed. Because NoesisGUI API does not use interfaces in Unity, this behavior is emulated by using the method <em>Noesis.Extend.PropertyChanged</em>:</p>
<div class="highlight"><pre><span class="k">public</span> <span class="k">class</span> <span class="nc">UnityObject</span> <span class="p">:</span> <span class="n">BaseComponent</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="n">HandleRef</span> <span class="n">swigCPtr</span><span class="p">;</span>

    <span class="k">public</span> <span class="kt">string</span> <span class="n">Type</span>
    <span class="p">{</span>
        <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">mType</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">set</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">mType</span> <span class="p">!=</span> <span class="k">value</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">mType</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
                <span class="n">Noesis</span><span class="p">.</span><span class="n">Extend</span><span class="p">.</span><span class="n">PropertyChanged</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">UnityObject</span><span class="p">),</span> <span class="n">swigCPtr</span><span class="p">.</span><span class="n">Handle</span><span class="p">,</span> <span class="s">&quot;Type&quot;</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="n">SolidColorBrush</span> <span class="n">Color</span>
    <span class="p">{</span>
        <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">mColor</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">set</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">mColor</span> <span class="p">!=</span> <span class="k">value</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">mColor</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
                <span class="n">Noesis</span><span class="p">.</span><span class="n">Extend</span><span class="p">.</span><span class="n">PropertyChanged</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">UnityObject</span><span class="p">),</span> <span class="n">swigCPtr</span><span class="p">.</span><span class="n">Handle</span><span class="p">,</span> <span class="s">&quot;Color&quot;</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="kt">string</span> <span class="n">Scale</span>
    <span class="p">{</span>
        <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">mScale</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">set</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">mScale</span> <span class="p">!=</span> <span class="k">value</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">mScale</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
                <span class="n">Noesis</span><span class="p">.</span><span class="n">Extend</span><span class="p">.</span><span class="n">PropertyChanged</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">UnityObject</span><span class="p">),</span> <span class="n">swigCPtr</span><span class="p">.</span><span class="n">Handle</span><span class="p">,</span> <span class="s">&quot;Scale&quot;</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="kt">string</span> <span class="n">Pos</span>
    <span class="p">{</span>
        <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">mPos</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">set</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">mPos</span> <span class="p">!=</span> <span class="k">value</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">mPos</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
                <span class="n">Noesis</span><span class="p">.</span><span class="n">Extend</span><span class="p">.</span><span class="n">PropertyChanged</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">UnityObject</span><span class="p">),</span> <span class="n">swigCPtr</span><span class="p">.</span><span class="n">Handle</span><span class="p">,</span> <span class="s">&quot;Pos&quot;</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Register</span><span class="p">()</span>
    <span class="p">{</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="nf">UnityObject</span><span class="p">(</span><span class="n">IntPtr</span> <span class="n">cPtr</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">cMemoryOwn</span><span class="p">):</span> <span class="k">base</span><span class="p">(</span><span class="n">cPtr</span><span class="p">,</span> <span class="n">cMemoryOwn</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">swigCPtr</span> <span class="p">=</span> <span class="k">new</span> <span class="n">HandleRef</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">cPtr</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="nf">UnityObject</span><span class="p">():</span> <span class="k">this</span><span class="p">(</span><span class="n">Noesis</span><span class="p">.</span><span class="n">Extend</span><span class="p">.</span><span class="n">New</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">UnityObject</span><span class="p">)),</span> <span class="k">true</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Noesis</span><span class="p">.</span><span class="n">Extend</span><span class="p">.</span><span class="n">New</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">UnityObject</span><span class="p">),</span> <span class="n">swigCPtr</span><span class="p">.</span><span class="n">Handle</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>

    <span class="p">}</span>

    <span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">Dispose</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">lock</span> <span class="p">(</span><span class="k">this</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">swigCPtr</span><span class="p">.</span><span class="n">Handle</span> <span class="p">!=</span> <span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">swigCMemOwn</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">swigCMemOwn</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">Noesis</span><span class="p">.</span><span class="n">Kernel</span><span class="p">.</span><span class="n">IsInitialized</span><span class="p">())</span>
                    <span class="p">{</span>
                        <span class="n">Noesis</span><span class="p">.</span><span class="n">Extend</span><span class="p">.</span><span class="n">Delete</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">UnityObject</span><span class="p">),</span> <span class="n">swigCPtr</span><span class="p">.</span><span class="n">Handle</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="n">swigCPtr</span> <span class="p">=</span> <span class="k">new</span> <span class="n">HandleRef</span><span class="p">(</span><span class="k">null</span><span class="p">,</span> <span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="n">GC</span><span class="p">.</span><span class="n">SuppressFinalize</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
            <span class="k">base</span><span class="p">.</span><span class="n">Dispose</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="kt">string</span> <span class="n">type</span><span class="p">;</span>
    <span class="k">private</span> <span class="n">SolidColorBrush</span> <span class="n">color</span><span class="p">;</span>
    <span class="k">private</span> <span class="kt">string</span> <span class="n">scale</span><span class="p">;</span>
    <span class="k">private</span> <span class="kt">string</span> <span class="n">pos</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<p>Instances of this class can be inserted in a collection that serves as data source for a ListBox, for example:</p>
<div class="highlight"><pre><span class="n">collection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Collection</span><span class="p">();</span>
<span class="n">collection</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">UnityObject</span><span class="p">());</span>
<span class="n">mainListBox</span><span class="p">.</span><span class="n">SetItemsSource</span><span class="p">(</span><span class="n">collection</span><span class="p">);</span>
</pre></div>
<div class="highlight"><pre><span class="nt">&lt;UserControl.Resources&gt;</span>
    <span class="nt">&lt;DataTemplate</span> <span class="na">x:Key=</span><span class="s">&quot;TaskTemplate&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;Grid&gt;</span>
            <span class="nt">&lt;Grid.ColumnDefinitions&gt;</span>
                <span class="nt">&lt;ColumnDefinition</span> <span class="na">Width=</span><span class="s">&quot;Auto&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;ColumnDefinition</span> <span class="na">Width=</span><span class="s">&quot;60&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;ColumnDefinition</span> <span class="na">Width=</span><span class="s">&quot;210&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;ColumnDefinition</span> <span class="na">Width=</span><span class="s">&quot;300&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/Grid.ColumnDefinitions&gt;</span>

            <span class="nt">&lt;Rectangle</span> <span class="na">Width=</span><span class="s">&quot;15&quot;</span> <span class="na">Height=</span><span class="s">&quot;10&quot;</span> <span class="na">Fill=</span><span class="s">&quot;{Binding Color}&quot;</span> <span class="na">Stroke=</span><span class="s">&quot;Transparent&quot;</span> <span class="na">StrokeThickness=</span><span class="s">&quot;0&quot;</span>
                <span class="na">Margin=</span><span class="s">&quot;5, 0, 5, 0&quot;</span> <span class="na">Grid.Column=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;TextBlock</span> <span class="na">Text=</span><span class="s">&quot;{Binding Type}&quot;</span> <span class="na">Margin=</span><span class="s">&quot;5, 0, 5, 0&quot;</span> <span class="na">Grid.Column=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;TextBlock</span> <span class="na">Text=</span><span class="s">&quot;{Binding Scale}&quot;</span> <span class="na">Margin=</span><span class="s">&quot;5, 0, 5, 0&quot;</span> <span class="na">Grid.Column=</span><span class="s">&quot;2&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;TextBlock</span> <span class="na">Text=</span><span class="s">&quot;{Binding Pos}&quot;</span> <span class="na">Margin=</span><span class="s">&quot;5, 0, 5, 0&quot;</span> <span class="na">Grid.Column=</span><span class="s">&quot;3&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/Grid&gt;</span>
    <span class="nt">&lt;/DataTemplate&gt;</span>
<span class="nt">&lt;/UserControl.Resources&gt;</span>

<span class="nt">&lt;ListBox</span> <span class="na">x:Name=</span><span class="s">&quot;mainListBox&quot;</span> <span class="na">Height=</span><span class="s">&quot;100&quot;</span> <span class="na">ItemTemplate=</span><span class="s">&quot;{StaticResource TaskTemplate}&quot;</span><span class="nt">&gt;&lt;/ListBox&gt;</span>
</pre></div>
</div>
<div class="section" id="commands">
<h1>Commands</h1>
<p>Commands are somewhat like events in that they are based on actions in the user interface. A command can get triggered (just like an event) but unlike regular events like 'Click', commands are built in a way that makes it very easy to expose the same functionality at multiple places in an interface, with very little code duplication.</p>
<p>The next sample, that can be found in NoesisGUI, shows how to use commands to build a MVVM. Two important classes are found in this sample:</p>
<ul class="simple">
<li><em>DelegateCommand</em>, the command itself. A command must be based on <em>Noesis.BaseCommand</em> and implement the methods <em>CanExecuteCommand</em> and <em>ExecuteCommand</em>.</li>
</ul>
<div class="highlight"><pre><span class="k">public</span> <span class="k">class</span> <span class="nc">DelegateCommand</span> <span class="p">:</span> <span class="n">Noesis</span><span class="p">.</span><span class="n">BaseCommand</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="n">HandleRef</span> <span class="n">swigCPtr</span><span class="p">;</span>

    <span class="k">private</span> <span class="k">readonly</span> <span class="n">Action</span> <span class="n">action</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Register</span><span class="p">()</span>
    <span class="p">{</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="nf">DelegateCommand</span><span class="p">(</span><span class="n">IntPtr</span> <span class="n">cPtr</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">cMemoryOwn</span><span class="p">)</span>
        <span class="p">:</span> <span class="k">base</span><span class="p">(</span><span class="n">cPtr</span><span class="p">,</span> <span class="n">cMemoryOwn</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">swigCPtr</span> <span class="p">=</span> <span class="k">new</span> <span class="n">HandleRef</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">cPtr</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="nf">DelegateCommand</span><span class="p">(</span><span class="n">Action</span> <span class="n">action</span><span class="p">):</span>
        <span class="k">this</span><span class="p">(</span><span class="n">Noesis</span><span class="p">.</span><span class="n">Extend</span><span class="p">.</span><span class="n">New</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">DelegateCommand</span><span class="p">)),</span> <span class="k">true</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Noesis</span><span class="p">.</span><span class="n">Extend</span><span class="p">.</span><span class="n">Register</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">DelegateCommand</span><span class="p">),</span> <span class="n">swigCPtr</span><span class="p">.</span><span class="n">Handle</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>

        <span class="k">this</span><span class="p">.</span><span class="n">action</span> <span class="p">=</span> <span class="n">action</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">Dispose</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">lock</span> <span class="p">(</span><span class="k">this</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">swigCPtr</span><span class="p">.</span><span class="n">Handle</span> <span class="p">!=</span> <span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">swigCMemOwn</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">swigCMemOwn</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">Noesis</span><span class="p">.</span><span class="n">Kernel</span><span class="p">.</span><span class="n">IsInitialized</span><span class="p">())</span>
                    <span class="p">{</span>
                        <span class="n">Noesis</span><span class="p">.</span><span class="n">Extend</span><span class="p">.</span><span class="n">Delete</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">DelegateCommand</span><span class="p">),</span> <span class="n">swigCPtr</span><span class="p">.</span><span class="n">Handle</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="n">swigCPtr</span> <span class="p">=</span> <span class="k">new</span> <span class="n">HandleRef</span><span class="p">(</span><span class="k">null</span><span class="p">,</span> <span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="n">GC</span><span class="p">.</span><span class="n">SuppressFinalize</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
            <span class="k">base</span><span class="p">.</span><span class="n">Dispose</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="kt">bool</span> <span class="nf">CanExecuteCommand</span><span class="p">(</span><span class="n">BaseComponent</span> <span class="n">parameter</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">ExecuteCommand</span><span class="p">(</span><span class="n">BaseComponent</span> <span class="n">parameter</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">action</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<ul class="simple">
<li><em>ViewModel</em> is the class in charge of binding data to the xaml and implementing the delegate that will be invoked by the command.  Note that this class must be serializable because it is used inside the xaml.</li>
</ul>
<div class="highlight"><pre><span class="k">public</span> <span class="k">class</span> <span class="nc">ViewModel</span> <span class="p">:</span> <span class="n">SerializableComponent</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="n">HandleRef</span> <span class="n">swigCPtr</span><span class="p">;</span>

    <span class="kt">string</span> <span class="n">_input</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">Input</span>
    <span class="p">{</span>
        <span class="k">get</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">_input</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">set</span>
        <span class="p">{</span>
            <span class="n">_input</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="kt">string</span> <span class="n">_output</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">Output</span>
    <span class="p">{</span>
        <span class="k">get</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">_output</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">set</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">_output</span> <span class="p">!=</span> <span class="k">value</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">_output</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
                <span class="n">Noesis</span><span class="p">.</span><span class="n">Extend</span><span class="p">.</span><span class="n">PropertyChanged</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">ViewModel</span><span class="p">),</span> <span class="n">swigCPtr</span><span class="p">.</span><span class="n">Handle</span><span class="p">,</span> <span class="s">&quot;Output&quot;</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="n">DelegateCommand</span> <span class="n">SayHelloCommand</span>
    <span class="p">{</span>
        <span class="k">get</span><span class="p">;</span>
        <span class="k">private</span> <span class="k">set</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Register</span><span class="p">()</span>
    <span class="p">{</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="nf">ViewModel</span><span class="p">(</span><span class="n">IntPtr</span> <span class="n">cPtr</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">cMemoryOwn</span><span class="p">)</span>
        <span class="p">:</span> <span class="k">base</span><span class="p">(</span><span class="n">cPtr</span><span class="p">,</span> <span class="n">cMemoryOwn</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">swigCPtr</span> <span class="p">=</span> <span class="k">new</span> <span class="n">HandleRef</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">cPtr</span><span class="p">);</span>

        <span class="n">SayHelloCommand</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DelegateCommand</span><span class="p">(</span><span class="n">SayHello</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="nf">ViewModel</span><span class="p">():</span>
        <span class="k">this</span><span class="p">(</span><span class="n">Noesis</span><span class="p">.</span><span class="n">Extend</span><span class="p">.</span><span class="n">New</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">ViewModel</span><span class="p">)),</span> <span class="k">true</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Noesis</span><span class="p">.</span><span class="n">Extend</span><span class="p">.</span><span class="n">Register</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">ViewModel</span><span class="p">),</span> <span class="n">swigCPtr</span><span class="p">.</span><span class="n">Handle</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">Dispose</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">lock</span> <span class="p">(</span><span class="k">this</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">swigCPtr</span><span class="p">.</span><span class="n">Handle</span> <span class="p">!=</span> <span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">swigCMemOwn</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">swigCMemOwn</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">Noesis</span><span class="p">.</span><span class="n">Kernel</span><span class="p">.</span><span class="n">IsInitialized</span><span class="p">())</span>
                    <span class="p">{</span>
                        <span class="n">Noesis</span><span class="p">.</span><span class="n">Extend</span><span class="p">.</span><span class="n">Delete</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">ViewModel</span><span class="p">),</span> <span class="n">swigCPtr</span><span class="p">.</span><span class="n">Handle</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="n">swigCPtr</span> <span class="p">=</span> <span class="k">new</span> <span class="n">HandleRef</span><span class="p">(</span><span class="k">null</span><span class="p">,</span> <span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="n">GC</span><span class="p">.</span><span class="n">SuppressFinalize</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
            <span class="k">base</span><span class="p">.</span><span class="n">Dispose</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">SayHello</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Output</span> <span class="p">=</span> <span class="s">&quot;Hello, &quot;</span> <span class="p">+</span> <span class="n">Input</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<p>The following Xaml shows how you might use the previous command. ViewModel is set as the <strong>DataContext</strong> of the Border. The button inside the panel gets the command assigned from ViewModel. Whenever the button is pressed the command is fired.</p>
<div class="highlight"><pre><span class="nt">&lt;Grid</span>
    <span class="na">xmlns=</span><span class="s">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span>
    <span class="na">xmlns:x=</span><span class="s">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span>
    <span class="na">xmlns:d=</span><span class="s">&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span>
    <span class="na">xmlns:mc=</span><span class="s">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span> <span class="na">mc:Ignorable=</span><span class="s">&quot;d&quot;</span>
    <span class="na">Height=</span><span class="s">&quot;60&quot;</span> <span class="na">d:DesignWidth=</span><span class="s">&quot;400&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;Grid.Resources&gt;</span>
        <span class="nt">&lt;ViewModel</span> <span class="na">x:Key=</span><span class="s">&quot;ViewModel&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/Grid.Resources&gt;</span>

    <span class="nt">&lt;Border</span> <span class="na">x:Name=</span><span class="s">&quot;myBorder&quot;</span> <span class="na">BorderThickness=</span><span class="s">&quot;5&quot;</span> <span class="na">CornerRadius=</span><span class="s">&quot;5&quot;</span> <span class="na">DataContext=</span><span class="s">&quot;{StaticResource ViewModel}&quot;</span>
            <span class="na">BorderBrush=</span><span class="s">&quot;Black&quot;</span> <span class="na">Height=</span><span class="s">&quot;Auto&quot;</span> <span class="na">Width=</span><span class="s">&quot;Auto&quot;</span> <span class="na">Background=</span><span class="s">&quot;White&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;StackPanel</span> <span class="na">Orientation=</span><span class="s">&quot;Horizontal&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;TextBox</span> <span class="na">Width=</span><span class="s">&quot;100&quot;</span> <span class="na">Margin=</span><span class="s">&quot;3&quot;</span> <span class="na">Text=</span><span class="s">&quot;{Binding Input, Mode=TwoWay}&quot;</span> <span class="na">FontSize=</span><span class="s">&quot;28&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;Button</span> <span class="na">Content=</span><span class="s">&quot;Say Hello&quot;</span> <span class="na">Margin=</span><span class="s">&quot;3&quot;</span> <span class="na">Command=</span><span class="s">&quot;{Binding SayHelloCommand}&quot;</span> <span class="na">FontSize=</span><span class="s">&quot;28&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;TextBlock</span> <span class="na">Margin=</span><span class="s">&quot;3&quot;</span> <span class="na">VerticalAlignment=</span><span class="s">&quot;Bottom&quot;</span> <span class="na">Text=</span><span class="s">&quot;{Binding Output}&quot;</span> <span class="na">FontSize=</span><span class="s">&quot;28&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/StackPanel&gt;</span>
    <span class="nt">&lt;/Border&gt;</span>
<span class="nt">&lt;/Grid&gt;</span>
</pre></div>
</div>
<div class="section" id="building-on-ios">
<h1>Building on iOS</h1>
<p>The process of building for iOS is not as straightforward as on Windows or OS X. Unity generates a XCode project that needs to be modified to incorporate NoesisGUI. Each time any Unity content changes the XCode project needs to be regenerated before it can be viewed on the iOS device. The steps to follow are:</p>
<ol class="arabic simple">
<li>Select File -&gt; Build Settings...</li>
</ol>
<img alt="Unity3DTutorialImg8.png" src="Unity3DTutorialImg8.png" />
<ol class="arabic simple" start="2">
<li>Select the Scenes to be deployed</li>
<li>Select platform iOS</li>
<li>Adjust the desired Player Settings (Resolution, Icons, Splash Image...). Make sure that Target iOS Version is at least 5.0. NoesisGUI is not compatible with previous iOS versions. Graphics Level must be set to OpenGL ES 2.0</li>
<li>Click the Build button</li>
<li>Select the location where you want to save the XCode project</li>
</ol>
<img alt="Unity3DTutorialImg9.png" src="Unity3DTutorialImg9.png" />
<ol class="arabic simple" start="7">
<li>If the project already exists a warning appears indicating if you want to Append or Replace. Select Append to avoid losing changes done on the XCode project.</li>
</ol>
<img alt="Unity3DTutorialImg10.png" src="Unity3DTutorialImg10.png" />
<ol class="arabic simple" start="8">
<li>Open the XCode project</li>
</ol>
<blockquote>
<p>Note that when returning to the Unity Editor, iOS platform is left active and an error is notified indicating that iOS editor mode is not compatible with NoesisGUI. You must activate PC, Mac &amp; Linux to continue working in the editor.</p>
<p>By default, Unity does not create a Stencil surface in iOS. As NoesisGUI renders masks using Stencil we need to modify the file GlesHelper.mm to activate this feature. Note that the changes are emphasized.</p>
<div class="highlight"><pre><span class="kt">void</span> <span class="nf">CreateSharedDepthbuffer</span><span class="p">(</span><span class="n">UnityRenderingSurface</span><span class="o">*</span> <span class="n">surface</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">EAGLContextSetCurrentAutoRestore</span> <span class="n">autorestore</span><span class="p">(</span><span class="n">surface</span><span class="o">-&gt;</span><span class="n">context</span><span class="p">);</span>
    <span class="n">DestroySharedDepthbuffer</span><span class="p">(</span><span class="n">surface</span><span class="p">);</span>

<span class="hll">    <span class="c1">//surface-&gt;depthFormat = surface-&gt;use24bitDepth ? GL_DEPTH_COMPONENT24_OES : GL_DEPTH_COMPONENT16_OES;</span>
</span><span class="hll">    <span class="n">surface</span><span class="o">-&gt;</span><span class="n">depthFormat</span> <span class="o">=</span> <span class="n">GL_DEPTH24_STENCIL8_OES</span><span class="p">;</span>
</span>
    <span class="n">GLES_CHK</span><span class="p">(</span><span class="n">glGenRenderbuffersOES</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">surface</span><span class="o">-&gt;</span><span class="n">depthRB</span><span class="p">));</span>
    <span class="n">GLES_CHK</span><span class="p">(</span><span class="n">glBindRenderbufferOES</span><span class="p">(</span><span class="n">GL_RENDERBUFFER_OES</span><span class="p">,</span> <span class="n">surface</span><span class="o">-&gt;</span><span class="n">depthRB</span><span class="p">));</span>

    <span class="kt">bool</span> <span class="n">needMSAA</span> <span class="o">=</span> <span class="n">GL_APPLE_framebuffer_multisample</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">surface</span><span class="o">-&gt;</span><span class="n">msaaSamples</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">);</span>

<span class="cp">#if GL_APPLE_framebuffer_multisample</span>
    <span class="k">if</span><span class="p">(</span><span class="n">needMSAA</span><span class="p">)</span>
        <span class="n">GLES_CHK</span><span class="p">(</span><span class="n">glRenderbufferStorageMultisampleAPPLE</span><span class="p">(</span><span class="n">GL_RENDERBUFFER_OES</span><span class="p">,</span> <span class="n">surface</span><span class="o">-&gt;</span><span class="n">msaaSamples</span><span class="p">,</span> <span class="n">surface</span><span class="o">-&gt;</span><span class="n">depthFormat</span><span class="p">,</span> <span class="n">surface</span><span class="o">-&gt;</span><span class="n">targetW</span><span class="p">,</span> <span class="n">surface</span><span class="o">-&gt;</span><span class="n">targetH</span><span class="p">));</span>
<span class="cp">#endif</span>

    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">needMSAA</span><span class="p">)</span>
        <span class="n">GLES_CHK</span><span class="p">(</span><span class="n">glRenderbufferStorageOES</span><span class="p">(</span><span class="n">GL_RENDERBUFFER_OES</span><span class="p">,</span> <span class="n">surface</span><span class="o">-&gt;</span><span class="n">depthFormat</span><span class="p">,</span> <span class="n">surface</span><span class="o">-&gt;</span><span class="n">targetW</span><span class="p">,</span> <span class="n">surface</span><span class="o">-&gt;</span><span class="n">targetH</span><span class="p">));</span>

    <span class="n">GLES_CHK</span><span class="p">(</span><span class="n">glFramebufferRenderbufferOES</span><span class="p">(</span><span class="n">GL_FRAMEBUFFER_OES</span><span class="p">,</span> <span class="n">GL_DEPTH_ATTACHMENT_OES</span><span class="p">,</span> <span class="n">GL_RENDERBUFFER_OES</span><span class="p">,</span> <span class="n">surface</span><span class="o">-&gt;</span><span class="n">depthRB</span><span class="p">));</span>
<span class="hll">    <span class="n">GLES_CHK</span><span class="p">(</span><span class="n">glFramebufferRenderbufferOES</span><span class="p">(</span><span class="n">GL_FRAMEBUFFER_OES</span><span class="p">,</span> <span class="n">GL_STENCIL_ATTACHMENT_OES</span><span class="p">,</span> <span class="n">GL_RENDERBUFFER_OES</span><span class="p">,</span> <span class="n">surface</span><span class="o">-&gt;</span><span class="n">depthRB</span><span class="p">));</span>
</span><span class="p">}</span>
</pre></div>
</blockquote>
<ol class="arabic simple" start="9">
<li>Optimize deployed data</li>
</ol>
<blockquote>
By default all the directory /Assets/StreamingAssets of the Unity project is deployed to the device. Unity copies the entire directory to the /Raw folder of the XCode project. If you want to optimize the data that is copied to the device it is recommended to leave only the IOS folder in the ($XCODE_PROJECT_DIR)/Data/Raw/NoesisGUI/Data folder.</blockquote>
<ol class="arabic simple" start="10">
<li>Build and Run the project from XCode</li>
</ol>
</div>
<div class="section" id="building-on-android">
<h1>Building on Android</h1>
<p>The process of building for Android is very simple, only a few settings should be taken into account. The steps to follow are:</p>
<ol class="arabic simple">
<li>Optimize deployed data</li>
</ol>
<p>By default all the directory /Assets/StreamingAssets of the Unity project is deployed into the .apk package. If you want to optimize the data that is copied to the device it is recommended to select only the Android platform under Window -&gt; NoesisGUI -&gt; Settings window and click the Build button before you start the Unity building process.</p>
<ol class="arabic simple" start="2">
<li>Select File -&gt; Build Settings...</li>
</ol>
<img alt="Unity3DTutorialImg11.png" src="Unity3DTutorialImg11.png" />
<ol class="arabic simple" start="3">
<li>Select the Scenes to be deployed</li>
<li>Select platform Android</li>
<li>Adjust the desired Player Settings (Resolution, Icons, Splash Image...). Make sure that <strong>Minimum API Level</strong> is at least <em>Android 2.3.3 'Gingerbread'</em>. NoesisGUI is not compatible with previous Android versions. <strong>Graphics Level</strong> must be set to <em>OpenGL ES 2.0</em>. And <strong>Write Access</strong> must be set to <em>External (SDCard)</em> (this last requirement will be removed in future releases).</li>
<li>Click the Build button</li>
<li>Select the location where you want to save the .apk file</li>
<li>Install the .apk into your Android device and Run it</li>
</ol>
<p>You can also generate an <strong>Eclipse</strong> project to extend your application. In that case the steps are the following:</p>
<ol class="arabic simple">
<li>Select File -&gt; Build Settings...</li>
<li>Select the Scenes to be deployed</li>
<li>Select platform Android</li>
<li>Adjust the desired Player Settings (Resolution, Icons, Splash Image...). Make sure that <strong>Minimum API Level</strong> is at least <em>Android 2.3.3 'Gingerbread'</em>. NoesisGUI is not compatible with previous Android versions. <strong>Graphics Level</strong> must be set to <em>OpenGL ES 2.0</em></li>
<li>Click the Export button</li>
<li>Select the location where you want to store the Eclipse project</li>
<li>Optimize deployed data</li>
</ol>
<blockquote>
By default all the directory /Assets/StreamingAssets of the Unity project is deployed to the assets/ folder of the Eclipse project. If you want to optimize the data that is copied to the device it is recommended to leave only the ANDROID folder in ($ECLIPSE_PROJECT_DIR)/assets/NoesisGUI/Data/ folder.</blockquote>
<ol class="arabic simple" start="8">
<li>Build project with Eclipse to generate the .apk file</li>
<li>Install the .apk into your Android device and Run it</li>
</ol>
<p>Note that when returning to the Unity Editor, Android platform is left active and an error is notified indicating that Android editor mode is not compatible with NoesisGUI. You must switch to PC, Mac &amp; Linux platform to continue working in the editor.</p>
</div>
<br/>
<div>
    <div class="headerbg">
        <div class="footertext" style="height:32px; background:#262626;">
            &nbsp;<br/>2013 (C) Noesis Technologies
        </div>
    </div>
</div>
</div>
</body>
</html>
